(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"0911":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"wrap"},[n("v-uni-view",{staticClass:"top"}),1==t.iswx?n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"title"},[t._v("欢迎登录")]),n("v-uni-view",{staticClass:"u-flex u-row-between u-col-center"},[n("v-uni-input",{staticClass:"u-border-bottom",staticStyle:{width:"430rpx","font-size":"28rpx"},attrs:{type:"number",placeholder:"请输入手机号"},model:{value:t.tel,callback:function(e){t.tel=e},expression:"tel"}}),n("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[n("v-uni-text",{class:t.status?"u-color-balck3":"u-color-balck6"},[t._v(t._s(t.sendtit))])],1)],1),n("v-uni-view",{staticClass:"tips"},[t._v("未注册的手机号验证后自动创建账号")]),n("v-uni-input",{staticClass:"u-border-bottom",staticStyle:{"margin-bottom":"30rpx","font-size":"28rpx"},attrs:{type:"number",placeholder:"请输入验证码"},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}}),n("v-uni-button",{staticClass:"getCaptcha",style:[t.inputStyle],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.regbtn.apply(void 0,arguments)}}},[t._v("立即登录")]),t._e()],1):t._e(),2==t.iswx?n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"title"},[t._v("欢迎登录")])],1):t._e(),n("v-uni-view",{staticClass:"buttom u-margin-top-20"},[n("v-uni-view",{staticClass:"loginType u-flex u-row-center u-col-center"},[2==t.iswx?n("v-uni-view",{staticClass:"wechat item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loginwx.apply(void 0,arguments)}}},[n("i",{staticClass:"icon u-color-balck6",staticStyle:{color:"#53C240","font-size":"68rpx"}},[t._v("")]),n("v-uni-text",{staticClass:"u-margin-top-10",staticStyle:{color:"#53C240"}},[t._v("微信登录")])],1):t._e()],1),n("v-uni-view",{staticClass:"hint"},[t._v("登录代表同意"),n("v-uni-text",{staticClass:"link",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tiao("../texter/text_xieyi?id=1")}}},[t._v("用户协议、")]),n("v-uni-text",{staticClass:"link",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tiao("../texter/text_xieyi?id=2")}}},[t._v("隐私政策，")]),t._v("并授权使用您的账号信息（如昵称、头像）以便您统一管理")],1)],1)],1)},o=[]},"351b":function(t,e,n){"use strict";var i=n("f14e"),o=n.n(i);o.a},"947d":function(t,e,n){"use strict";n.r(e);var i=n("e71c"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"9dae":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */\r\n/**授权样式**/.wrap[data-v-7b0fd7bf]{font-size:%?28?%}.wrap .content[data-v-7b0fd7bf]{width:%?600?%;margin:%?80?% auto 0}.wrap .content .title[data-v-7b0fd7bf]{text-align:left;font-size:%?60?%;font-weight:500;margin-bottom:%?100?%}.wrap .content uni-input[data-v-7b0fd7bf]{text-align:left;margin-bottom:%?10?%;padding-bottom:%?6?%}.wrap .content .tips[data-v-7b0fd7bf]{color:#666;margin-bottom:%?30?%;margin-top:%?18?%;font-size:%?24?%}.wrap .content .getCaptcha[data-v-7b0fd7bf]{background-color:#4486f6;color:#fff;border:none;font-size:%?30?%;padding:%?12?% 0}.wrap .content .getCaptcha[data-v-7b0fd7bf]::after{border:none}.wrap .content .alternative[data-v-7b0fd7bf]{color:#ff7474;display:flex;justify-content:space-between;margin-top:%?30?%}.wrap .buttom .loginType[data-v-7b0fd7bf]{display:flex;padding:%?80?% %?80?% %?80?% %?80?%;justify-content:center}.wrap .buttom .loginType .item[data-v-7b0fd7bf]{display:flex;flex-direction:column;align-items:center;color:#ff7474;font-size:%?28?%}.wrap .buttom .hint[data-v-7b0fd7bf]{padding:%?20?% %?40?%;font-size:%?24?%;color:#444}.wrap .buttom .hint .link[data-v-7b0fd7bf]{color:#007aff}',""]),t.exports=e},e71c:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("caad"),n("2532"),n("c975"),n("e9c4");var i={data:function(){return{yz:2,tel:"",sendtit:"发送验证码",code:"",time1:!1,second:60,status:!0,isCanUse:!1,wxcode:"",token:"",encryptedData:"",iswx:1,avatarUrl:"/static/img/user/mo.png",img:""}},computed:{inputStyle:function(){var t={};return this.tel&&this.code&&(t.color="#fff",t.backgroundColor="#fa3534"),t}},onLoad:function(t){var e=window.location.href;if(e.includes("cn/?code")){var n=e.substring(0,e.length-2),i=n.indexOf("cn/")+3,o=n.substring(0,i),a=n.substring(i,n.length);n=o+"#/"+a;return window.location=n,console.log(n),!1}if(e.includes("com/?code")){n=e.substring(0,e.length-2),i=n.indexOf("com/")+4,o=n.substring(0,i),a=n.substring(i,n.length),n=o+"#/"+a;return window.location=n,console.log(n),!1}if(e.includes("vip/?code")){n=e.substring(0,e.length-2),i=n.indexOf("vip/")+4,o=n.substring(0,i),a=n.substring(i,n.length),n=o+"#/"+a;return window.location=n,console.log(n),!1}if(e.includes("cloud/?code")){n=e.substring(0,e.length-2),i=n.indexOf("cloud/")+6,o=n.substring(0,i),a=n.substring(i,n.length),n=o+"#/"+a;return window.location=n,console.log(n),!1}if(e.includes("net/?code")){n=e.substring(0,e.length-2),i=n.indexOf("net/")+4,o=n.substring(0,i),a=n.substring(i,n.length),n=o+"#/"+a;return window.location=n,console.log(n),!1}if(t.code)return this.wxcode=t.code,this.getopenid(),!1;this.iswx=this.$iswx,this.GetToken(),console.log(t)},onUnload:function(){clearInterval(this.time1)},methods:{onGetPhoneNumber:function(t){var e=t.detail.iv,n=t.detail.encryptedData;uni.request({url:this.$puburl+"resource/getphone",data:{encryptedData:n,iv:e,token:this.token},method:"POST",header:{"content-type":"application/json"},success:function(t){if("200"==t.data.code){var e=t.data.data.token,n=t.data.data.userlist;uni.setStorage({key:"userData",data:{vuex_token:e,vuex_user:n},success:function(){console.log("success")}}),setTimeout((function(){uni.reLaunch({url:"/pages/index/index"})}),300)}else uni.showToast({title:t.data.message,icon:"none",duration:2e3})}})},formSubmit:function(t){var e=t.detail.value,n=e.nick,i=this.img;this.updateUserInfo(n,i)},onChooseAvatar:function(t){var e=t.detail.avatarUrl;this.avatarUrl=e,this.upload(e)},upload:function(t){var e=this;uni.uploadFile({url:e.$puburl+"resource/img_upload",filePath:t,name:"file",fileType:"image",formData:{token:e.token,type:1},success:function(t){t=JSON.parse(t.data);console.log(t.code),200==t.code?e.img=t.img:uni.showToast({title:t.message,icon:"none",duration:2e3})}})},GetToken:function(){var t=this;uni.getStorage({key:"userData",success:function(e){t.token=e.data.vuex_token},fail:function(){2==t.iswx&&t.getUserInfo()}})},loginwx:function(){this.getUserInfo()},wxGetUserInfo:function(){var t=this;console.log("xxxx"),uni.getUserProfile({desc:"获取用户信息用于登录",lang:"zh_CN",success:function(e){t.encryptedData=e.encryptedData,t.iv=e.iv,console.log(JSON.stringify(e)),uni.setStorageSync("isCanUse",!1),t.updateUserInfo()},fail:function(t){console.log(JSON.stringify(t))}})},login:function(){var t=this;uni.showLoading({title:"登录中..."});var e=this.$merid;uni.login({provider:"weixin",success:function(n){console.log(n);var i=n.code,o=0,a=uni.getStorageSync("invitation");a&&a.uid&&(o=a.uid),uni.request({url:t.$puburl+"resource/wxregister",data:{code:i,merid:e,uid:o},method:"GET",header:{"content-type":"application/json"},success:function(e){if(console.log(JSON.stringify(e)),1==e.data.code)t.token=e.data.data.token,t.isCanUse=!0;else if(2==e.data.code)t.token=e.data.data.token,t.isCanUse=!0,t.yz=1;else if("200"==e.data.code){var n=e.data.data.token,i=e.data.data.userlist;uni.setStorage({key:"userData",data:{vuex_token:n,vuex_user:i},success:function(){console.log("success")}}),setTimeout((function(){uni.reLaunch({url:"/pages/index/index"})}),300)}else uni.showToast({title:e.data.message,icon:"none",duration:2e3});uni.hideLoading()},fail:function(t){console.log(t),uni.hideLoading()}})}})},updateUserInfo:function(t,e){var n=this;uni.request({url:n.$puburl+"resource/getuserinfo",data:{nick:t,img:n.img,token:n.token},method:"POST",header:{"content-type":"application/json"},success:function(t){if("200"==t.data.code){var e=t.data.data.token,i=t.data.data.userlist;uni.setStorage({key:"userData",data:{vuex_token:e,vuex_user:i},success:function(){console.log("success")}}),setTimeout((function(){uni.reLaunch({url:"/pages/index/index"})}),300)}else 2==t.data.code?(n.token=t.data.data.token,n.isCanUse=!0,n.yz=1):uni.showToast({title:t.data.message,icon:"none",duration:2e3})}})},wxh5login:function(){jweixin.ready((function(){}))},getUserInfo:function(){if(this.$wxurl){var t=this.$wxurl+"?type=3&merid="+this.$merid;t=encodeURI(t)}else{t=this.$puburl+"?merid="+this.$merid;t=encodeURI(t)}window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+this.$wxappid+"&redirect_uri="+t+"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect",console.log(this.code),this.code},getopenid:function(){var t=this;if(this.wxcode){uni.showLoading({title:"登录中..."});var e=0,n=uni.getStorageSync("invitation");n&&n.uid&&(e=n.uid),uni.request({url:t.$puburl+"resource/wxregister",data:{code:this.wxcode,uid:e},method:"GET",header:{"content-type":"application/json"},success:function(e){console.log(JSON.stringify(e)),1==e.data.code?t.token=e.data.data.token:uni.showToast({title:e.data.message,icon:"none",duration:2e3}),uni.hideLoading()},fail:function(t){console.log(t),uni.hideLoading()}})}else uni.showToast({icon:"none",title:"请先登录"})},tiao:function(t){uni.navigateTo({url:t})},appLoginWx:function(){uni.login({provider:"weixin",success:function(t){console.log(t)}})},codest:function(){var t=this;this.sendtit="倒计时60s",this.time1=setInterval((function(){var e=--t.second;t.sendtit="倒计时"+e+"s",console.log(e),e<1&&(clearInterval(t.time1),t.status=!0,t.sendtit="发送验证码")}),1e3)},regbtn:function(){if(!this.tel)return uni.showToast({title:"请输入手机号",icon:"none",duration:2e3}),!1;if(!this.code)return uni.showToast({title:"请输入验证码",icon:"none",duration:2e3}),!1;var t=0,e=uni.getStorageSync("invitation");e&&e.uid&&(t=e.uid),this.$api.phonelogin({mobile:this.tel,code:this.code,uid:t}).then((function(t){if(200==t.data.code){uni.showToast({title:t.data.message,icon:"none",duration:2e3});var e=t.data.data.token,n=t.data.data.userlist;uni.setStorage({key:"userData",data:{vuex_token:e,vuex_user:n},success:function(){console.log("success")}}),setTimeout((function(){uni.switchTab({url:"/pages/index/index"})}),1200)}else uni.showToast({title:t.data.message,icon:"none",duration:2e3})}))},submit:function(){var t=this;return this.status?this.tel?void this.$api.smssend({mobile:this.tel,type:"login"}).then((function(e){200==e.data.code?(uni.showToast({title:e.data.message,icon:"none",duration:2e3}),t.codest(),t.status=!1):uni.showToast({title:e.data.message,icon:"none",duration:2e3})})):(uni.showToast({title:"请输入手机号",icon:"none",duration:2e3}),!1):(uni.showToast({title:"请不要频繁发送",icon:"none",duration:2e3}),!1)}}};e.default=i},eb23:function(t,e,n){"use strict";n.r(e);var i=n("0911"),o=n("947d");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("351b");var s=n("f0c5"),u=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"7b0fd7bf",null,!1,i["a"],void 0);e["default"]=u.exports},f14e:function(t,e,n){var i=n("9dae");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=n("4f06").default;o("62ac70f6",i,!0,{sourceMap:!1,shadowMode:!1})}}]);